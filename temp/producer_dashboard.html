<link rel="stylesheet" href="producer_dashboard.css">

<header>
    <h1>‚ö° Producer Dashboard</h1>
    <a href="{{ url_for('logout') }}" class="logout">Logout</a>
</header>

<div class="dashboard-info">
    <p><strong>üîã Energy Available (kWh):</strong> {{ energy_available }}</p>
    <p><strong>üí∞ Tokens:</strong> {{ tokens }}</p>
    <p><strong>üè¶ Balance:</strong> ‚Çπ{{ balance }}</p>
    <p><strong>üìä Market Price:</strong> ‚Çπ{{ market_price }}</p>
</div>

<section class="actions" style="display: flex; gap: 20px; justify-content: center;">
    <div class="card">
        <h3>‚ö° Add Energy</h3>
        <form method="POST" style="display: flex; flex-direction: column; gap: 10px; align-items: flex-start;">
            <label for="energy">Energy Produced (kWh):</label>
            <div style="display: flex; gap: 10px; align-items: center;">
                <input type="number" id="energy" name="energy" min="0.1" step="0.1" required>
                <button type="submit">Add Energy</button>
            </div>
        </form>
    </div>
    
    <div class="card">
        <h3>üí∏ Withdraw Funds</h3>
        <form method="POST" style="display: flex; flex-direction: column; gap: 10px; align-items: flex-start;">
            <label for="withdraw_amount">Amount to Withdraw (‚Çπ):</label>
            <div style="display: flex; gap: 10px; align-items: center;">
                <input type="number" id="withdraw_amount" name="withdraw_amount" min="0.1" step="0.1" required>
                <button type="submit">Withdraw Funds</button>
            </div>
        </form>
    </div>
</section>

<a href="{{ url_for('history') }}" class="history-link">üìú View Transaction History</a>

<h3>üìâ Market Price History</h3>
<canvas id="priceChart" width="400" height="200"></canvas>
<script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
<script>
    const ctx = document.getElementById('priceChart').getContext('2d');
    new Chart(ctx, {
        type: 'line',
        data: {
            labels: ['10 AM', '11 AM', '12 PM', '1 PM', '2 PM'],
            datasets: [{
                label: 'Market Price (‚Çπ)',
                data: [9, 10, 11, 12, 10.5],
                borderColor: '#ff6b6b',
                backgroundColor: 'rgba(235, 52, 107, 0.2)',
                fill: true,
                tension: 0.4
            }]
        },
        options: { responsive: true ,
            plugins: {
            legend: {
                labels: {
                    color: '#d9eb34',  // Change legend text color
                    font: {
                        size: 16,  // Change legend font size
                        weight: 'bold'
                    }
                }
            }
        },
            scales: {
            x: {
                ticks: {
                    color: '#d9eb34',
                    font:{
                        size:16
                    } 
                }
            },
            y: {
                ticks: {
                    color: '#d9eb34', 
                    font:{
                        size:16
                    } 
                }
            }
        }
        }
    });
</script>